"use strict";(self["webpackChunkebookstore"]=self["webpackChunkebookstore"]||[]).push([[787],{1137:function(t,a,e){e.d(a,{Z:function(){return x}});var l=e(6252),s=e(3577);const o={class:"zones section_process py-5"},r={class:"container"},n={class:"row justify-content-center"},i={class:"col-md-10"},d={class:"step-wrap"},c=(0,l._)("div",{class:"step step1 done"},[(0,l._)("h3",null,"1"),(0,l._)("span",{class:"txt"},"確認訂單")],-1),u=(0,l._)("h3",null,"2",-1),p=(0,l._)("span",{class:"txt"},"確認付款",-1),m=[u,p],_=(0,l._)("h3",null,"3",-1),f=(0,l._)("span",{class:"txt"},"完成訂單",-1),h=[_,f],b={class:"progress"};function y(t,a,e,u,p,_){return(0,l.wg)(),(0,l.iD)("section",o,[(0,l._)("div",r,[(0,l._)("div",n,[(0,l._)("div",i,[(0,l._)("div",d,[c,(0,l._)("div",{class:(0,s.C_)(["step step2",{done:2===e.step||3===e.step}])},m,2),(0,l._)("div",{class:(0,s.C_)(["step step3",{done:3===e.step}])},h,2)]),(0,l._)("div",b,[(0,l._)("div",{class:(0,s.C_)(["progress-bar bg-primaryLight",{step2:2===e.step,step3:3===e.step}]),role:"progressbar","aria-valuenow":"50","aria-valuemin":"0","aria-valuemax":"100"},null,2)])])])])])}var g={data(){return{}},props:["step"]},w=e(3744);const v=(0,w.Z)(g,[["render",y]]);var x=v},2787:function(t,a,e){e.r(a),e.d(a,{default:function(){return Ut}});var l=e(6252),s=e(3577),o=e(9963);const r=t=>((0,l.dD)("data-v-3ab57cb2"),t=t(),(0,l.Cn)(),t),n=r((()=>(0,l._)("div",{class:"spinner-border text-primaryDark m-5",role:"status"},[(0,l._)("span",{class:"visually-hidden"},"Loading...")],-1))),i={class:"bg-light"},d=r((()=>(0,l._)("div",{style:{height:"50px"}},null,-1))),c={class:"container"},u={class:"row"},p={class:"col-md-8 pb-4"},m=r((()=>(0,l._)("h2",{class:"fs-4 fs-md-3 d-inline-block text-primaryDark p-2 fw-bold mb-6"},"確認訂單",-1))),_={key:0,class:"w-100 d-flex flex-column align-items-center py-5"},f=r((()=>(0,l._)("i",{class:"fa-solid fa-triangle-exclamation text-primaryDark fa-2x mb-3"},null,-1))),h=r((()=>(0,l._)("p",{class:"fw-bold mb-4"},"購物車內沒有商品",-1))),b=[f,h],y={class:"table align-middle"},g=r((()=>(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{width:"20%"}),(0,l._)("th",{class:"d-none d-md-table-cell text-start",width:"30%"}," 名稱 "),(0,l._)("th",{class:"d-table-cell d-md-none text-start",width:"40%"}," 名稱 "),(0,l._)("th",{class:"d-md-table-cell text-center"}," 單價 "),(0,l._)("th",{class:"d-none d-none d-md-table-cell text-center"}," 數量 "),(0,l._)("th")])],-1))),w=["src","alt"],v={class:"fw-bold"},x={class:"input-group d-md-none"},k={key:0,class:"text-danger fs-small"},D={class:"input-group w-md-75"},C=["onClick"],V=r((()=>(0,l._)("i",{class:"fa-solid fa-minus"},null,-1))),q=[V],U=["max","onUpdate:modelValue","onChange"],W=["onClick"],L=r((()=>(0,l._)("i",{class:"fa-solid fa-plus text-white"},null,-1))),E=[L],S={key:0,class:"text-danger fw-bold fs-small"},$={class:"fw-bold text-primaryDark"},I={class:"text-center d-none d-md-table-cell"},P={key:0,class:"text-danger fs-small ms-2"},z={class:"input-group"},Z={class:"input-group"},M=["onClick"],N=r((()=>(0,l._)("i",{class:"fa-solid fa-minus"},null,-1))),O=[N],R=["max","onUpdate:modelValue","onChange"],T=["onClick"],H=r((()=>(0,l._)("i",{class:"fa-solid fa-plus text-white"},null,-1))),J=[H],Y=["onClick"],j=r((()=>(0,l._)("i",{class:"fa-solid fa-trash text-primaryDark cursor-pointer"},null,-1))),B=[j],F={class:"row flex-sm-row align-items-center flex-column-reverse"},K={class:"col-md-6"},A={class:"p-3"},G={class:"input-group mb-3"},Q={key:0,type:"text",class:"form-control",placeholder:"已套用優惠券",disabled:""},X={class:"col-md-6"},tt=(0,l.Uk)(" 小計 : "),at={class:"text-primaryDark fw-bold"},et={key:0,class:"text-end text-danger mb-3 fw-bold"},lt={key:1,class:"text-secondaryDark fw-bold text-end mb-3 fs-md-4"},st={class:"col-md-4"},ot=r((()=>(0,l._)("h2",{class:"category fs-4 fs-md-3 d-inline-block text-primaryDark p-2 fw-bold mb-6"},"填寫訂購人資料",-1))),rt={class:"mb-3"},nt=r((()=>(0,l._)("label",{for:"Email",class:"form-label fw-bold text-white"},[(0,l.Uk)("Email"),(0,l._)("span",{class:"text-danger"},"*")],-1))),it={class:"mb-3"},dt=r((()=>(0,l._)("label",{for:"name",class:"form-label fw-bold text-white"},[(0,l.Uk)("訂購人姓名"),(0,l._)("span",{class:"text-danger"},"*")],-1))),ct={class:"mb-3"},ut=r((()=>(0,l._)("label",{for:"tel",class:"form-label fw-bold text-white"},[(0,l.Uk)("訂購人電話"),(0,l._)("span",{class:"text-danger"},"*")],-1))),pt={class:"mb-3",style:{height:"100px"}},mt=r((()=>(0,l._)("label",{for:"address",class:"form-label fw-bold text-white"},[(0,l.Uk)("訂購人地址"),(0,l._)("span",{class:"text-danger"},"*")],-1))),_t={class:"mb-3"},ft=r((()=>(0,l._)("label",{for:"message",class:"form-label fw-bold text-white"},"備註",-1))),ht={class:"text-end"},bt=r((()=>(0,l._)("div",{class:"bg-light",style:{height:"100px"}},null,-1)));function yt(t,a,e,r,f,h){const V=(0,l.up)("LoadingView"),L=(0,l.up)("OrderSteps"),N=(0,l.up)("router-link"),H=(0,l.up)("field-view"),j=(0,l.up)("error-message"),yt=(0,l.up)("form-view");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(V,{class:"loading",active:t.isLoading},{default:(0,l.w5)((()=>[n])),_:1},8,["active"]),(0,l._)("div",i,[(0,l.Wm)(L,{cartData:t.cartData,step:f.step},null,8,["cartData","step"]),d,(0,l._)("div",c,[(0,l._)("div",u,[(0,l._)("div",p,[m,0===t.cartData.carts.length?((0,l.wg)(),(0,l.iD)("div",_,b)):(0,l.kq)("",!0),(0,l._)("table",y,[g,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.cartData.carts,(a=>((0,l.wg)(),(0,l.iD)("tr",{key:a.id},[(0,l._)("td",null,[(0,l.Wm)(N,{class:"overflow-hidden me-2",to:`/product/${a.product.id}`},{default:(0,l.w5)((()=>[(0,l._)("img",{class:"imgbox_small1",src:a.product.imageUrl,alt:a.product.title},null,8,w)])),_:2},1032,["to"])]),(0,l._)("td",null,[(0,l._)("p",v,(0,s.zw)(a.product.title),1),(0,l._)("div",x,[(0,l._)("p",null,[a.qty>=a.product.inventory?((0,l.wg)(),(0,l.iD)("span",k,"選取已達上限")):(0,l.kq)("",!0)]),(0,l._)("div",D,[(0,l._)("button",{class:(0,s.C_)(["btn btn-outline-primaryDark minus fs-small",{disabled:a.qty<=1}]),type:"button",onClick:e=>t.updateCart(a,a.qty--)},q,10,C),(0,l.wy)((0,l._)("input",{type:"number",class:"form-control text-center box-shadow-none fs-small",min:"1",max:a.product.inventory,"onUpdate:modelValue":t=>a.qty=t,onChange:e=>t.updateCart(a),readonly:""},null,40,U),[[o.nr,a.qty,void 0,{lazy:!0}]]),(0,l._)("button",{class:(0,s.C_)(["btn btn-primaryDark plus fs-small",{disabled:a.qty>=a.product.inventory}]),type:"button",onClick:e=>t.updateCart(a,a.qty++)},E,10,W)])])]),(0,l._)("td",null,[a.coupon?((0,l.wg)(),(0,l.iD)("p",S,"已套用優惠券")):(0,l.kq)("",!0),(0,l._)("p",$,"NT$ "+(0,s.zw)(a.product.price),1)]),(0,l._)("td",I,[(0,l._)("p",null,[a.qty>=a.product.inventory?((0,l.wg)(),(0,l.iD)("span",P,"選取已達上限")):(0,l.kq)("",!0)]),(0,l._)("div",z,[(0,l._)("div",Z,[(0,l._)("button",{class:(0,s.C_)(["btn btn-outline-primaryDark minus fs-small",{disabled:a.qty<=1}]),type:"button",onClick:e=>t.updateCart(a,a.qty--)},O,10,M),(0,l.wy)((0,l._)("input",{type:"number",class:"form-control text-center box-shadow-none fs-small",min:"1",max:a.product.inventory,"onUpdate:modelValue":t=>a.qty=t,onChange:e=>t.updateCart(a),readonly:""},null,40,R),[[o.nr,a.qty,void 0,{lazy:!0}]]),(0,l._)("button",{class:(0,s.C_)(["btn btn-primaryDark plus fs-small",{disabled:a.qty>=a.product.inventory}]),type:"button",onClick:e=>t.updateCart(a,a.qty++)},J,10,T)])])]),(0,l._)("td",{class:"delCartItem text-center",onClick:e=>t.delCartItem(a)},B,8,Y)])))),128))])]),(0,l._)("div",F,[(0,l._)("div",K,[(0,l.wy)((0,l._)("div",A,[(0,l._)("div",G,[t.cartData.final_total!==t.cartData.total?((0,l.wg)(),(0,l.iD)("input",Q)):(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:1,type:"text",class:"form-control",placeholder:"輸入優惠券","onUpdate:modelValue":a[0]||(a[0]=t=>f.coupon_code=t),"aria-label":"coupon","aria-describedby":"coupon"},null,512)),[[o.nr,f.coupon_code]]),(0,l._)("button",{class:(0,s.C_)(["btn btn-primaryLight text-white",{disabled:t.cartData.final_total!==t.cartData.total}]),type:"button",id:"coupon",onClick:a[1]||(a[1]=(...t)=>h.addCoupon&&h.addCoupon(...t))},"套用優惠券",2)])],512),[[o.F8,t.cartData.carts.length]])]),(0,l._)("div",X,[(0,l._)("p",{class:(0,s.C_)(["text-end fs-4",{"mb-3":t.cartData.final_total!==t.cartData.total}])},[tt,(0,l._)("span",at,"NT$ "+(0,s.zw)(t.cartData.total),1)],2),t.cartData.final_total!==t.cartData.total?((0,l.wg)(),(0,l.iD)("p",et,"折扣 : "+(0,s.zw)(f.discount_price),1)):(0,l.kq)("",!0),t.cartData.final_total!==t.cartData.total?((0,l.wg)(),(0,l.iD)("p",lt," 應付金額 : NT$"+(0,s.zw)(f.final_total),1)):(0,l.kq)("",!0)])])]),(0,l._)("div",st,[(0,l.Wm)(yt,{ref:"form",class:"bg-primaryLight p-4 p-md-8 shadow"},{default:(0,l.w5)((({errors:t})=>[ot,(0,l._)("div",rt,[nt,(0,l.Wm)(H,{id:"Email",name:"Email",type:"Email",class:(0,s.C_)(["form-control",{"is-invalid":t["Email"]}]),rules:"required",placeholder:"請輸入 Email",modelValue:f.form.user.email,"onUpdate:modelValue":a[2]||(a[2]=t=>f.form.user.email=t)},null,8,["class","modelValue"]),(0,l.Wm)(j,{name:"Email",class:"invalid-feedback text-start"})]),(0,l._)("div",it,[dt,(0,l.Wm)(H,{id:"name",name:"姓名",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":t["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:f.form.user.name,"onUpdate:modelValue":a[3]||(a[3]=t=>f.form.user.name=t)},null,8,["class","modelValue"]),(0,l.Wm)(j,{name:"姓名",class:"invalid-feedback"})]),(0,l._)("div",ct,[ut,(0,l.Wm)(H,{id:"tel",name:"電話",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":t["電話"]}]),placeholder:"請輸入電話",rules:h.isPhone,modelValue:f.form.user.tel,"onUpdate:modelValue":a[4]||(a[4]=t=>f.form.user.tel=t)},null,8,["class","rules","modelValue"]),(0,l.Wm)(j,{name:"電話",class:"invalid-feedback"})]),(0,l._)("div",pt,[mt,(0,l.Wm)(H,{id:"address",name:"地址",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":t["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:f.form.user.address,"onUpdate:modelValue":a[5]||(a[5]=t=>f.form.user.address=t)},null,8,["class","modelValue"]),(0,l.Wm)(j,{name:"地址",class:"invalid-feedback"})]),(0,l._)("div",_t,[ft,(0,l.wy)((0,l._)("textarea",{id:"message",class:"form-control min-h-25","onUpdate:modelValue":a[6]||(a[6]=t=>f.form.message=t)},null,512),[[o.nr,f.form.message]])]),(0,l._)("div",ht,[(0,l._)("button",{type:"submit",class:"btn btn-primaryDark text-white w-100",onClick:a[7]||(a[7]=(0,o.iM)(((...t)=>h.onSubmit&&h.onSubmit(...t)),["prevent"]))},"送出訂單")])])),_:1},512)])])])]),bt],64)}var gt=e(1137),wt=e(8262),vt=e(4677),xt=e(6294),kt=e(6455),Dt=e.n(kt),Ct={data(){return{step:1,final_total:"",discount_price:"",form:{user:{payment:"",name:"",email:"",tel:"",address:""},message:""},coupon_code:"",orderId:this.$route.params.id,resentlyViewdProducts:JSON.parse(localStorage.getItem("resentlyViewdProducts"))||[]}},components:{OrderSteps:gt.Z},watch:{cartData:{handler(){this.final_total=Math.round(this.cartData.final_total)},deep:!0},final_total:{handler(){this.discount_price=this.final_total-this.cartData.total},deep:!0}},computed:{...(0,wt.rn)(vt.Z,["cartData"]),...(0,wt.rn)(xt.Z,["isLoading"])},methods:{...(0,wt.nv)(vt.Z,["getCartList","updateCart","delCartItem"]),...(0,wt.nv)(xt.Z,["loadingEffect","pushMsg"]),isPhone(t){const a=/^(09)[0-9]{8}$/;return!!a.test(t)||"需要正確的電話號碼"},onSubmit(){0===this.cartData.carts.length?this.pushMsg(!1,"送出","購物車還是空的呢!"):this.$http.post("https://vue3-course-api.hexschool.io/api/claire-api/order",{data:this.form}).then((t=>{this.pushMsg(t,"送出","已成功送出訂單"),this.form.message="",this.getCartList(),this.$router.push(`/checkout/${t.data.orderId}`)})).catch((()=>{this.pushMsg(!1,"送出","送出訂單失敗")}))},addCoupon(){const t="https://vue3-course-api.hexschool.io/api/claire-api/coupon",a={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:a}).then((t=>{this.getCartList(),Dt().fire({position:"center",icon:"success",title:"已套用優惠券!!!",showConfirmButton:!1,timer:2e3})}))},getResentlyViewdProducts(){this.resentlyViewdProducts=JSON.parse(localStorage.getItem("resentlyViewdProducts"))||[]},clearRecentlyViewed(){this.loadingEffect(),localStorage.removeItem("resentlyViewdProducts"),this.getResentlyViewdProducts()}},mounted(){this.final_total=Math.round(this.cartData.final_total),this.discount_price=this.final_total-this.cartData.total}},Vt=e(3744);const qt=(0,Vt.Z)(Ct,[["render",yt],["__scopeId","data-v-3ab57cb2"]]);var Ut=qt}}]);
//# sourceMappingURL=787.f6b5031e.js.map