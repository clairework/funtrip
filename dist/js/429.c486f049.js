"use strict";(self["webpackChunkebookstore"]=self["webpackChunkebookstore"]||[]).push([[429],{6614:function(t,e,a){a.d(e,{Z:function(){return w}});var s=a(6252),l=a(3577),i=a(9963);const r={"aria-label":"Page navigation"},o={class:"pagination d-flex align-items-center"},d=(0,s._)("span",{"aria-hidden":"true"},"«",-1),n=[d],p=["onClick"],c=(0,s._)("span",{"aria-hidden":"true"},"»",-1),m=[c];function u(t,e,a,d,c,u){return(0,s.wg)(),(0,s.iD)("nav",r,[(0,s._)("ul",o,[(0,s._)("li",{class:(0,l.C_)(["page-item",{disabled:!a.pages.has_pre}])},[(0,s._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=(0,i.iM)((e=>(t.$emit("update-page",a.pages.category,a.pages.current_page-1),u.goTop())),["prevent"]))},n)],2),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.pages.total_pages,((e,r)=>((0,s.wg)(),(0,s.iD)("li",{class:(0,l.C_)(["page-item",{active:e===a.pages.current_page}]),key:r},[(0,s._)("a",{class:(0,l.C_)(["page-link",{"pointer-none":e===a.pages.current_page}]),href:"#",onClick:(0,i.iM)((s=>(t.$emit("update-page",a.pages.category,e),u.goTop())),["prevent"])},(0,l.zw)(e),11,p)],2)))),128)),(0,s._)("li",{class:(0,l.C_)(["page-item",{disabled:!a.pages.has_next}])},[(0,s._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,i.iM)((e=>(t.$emit("update-page",a.pages.category,a.pages.current_page+1),u.goTop())),["prevent"]))},m)],2)])])}var g={props:["pages"],methods:{goTop(){document.documentElement.scrollTop=0}}},h=a(3744);const _=(0,h.Z)(g,[["render",u]]);var w=_},429:function(t,e,a){a.r(e),a.d(e,{default:function(){return Nt}});var s=a(6252),l=a(3577),i=a(9963);const r=(0,s._)("div",{class:"spinner-border text-primaryLight m-5",role:"status"},[(0,s._)("span",{class:"visually-hidden"},"Loading...")],-1),o={class:"container"},d=(0,s._)("h2",{class:"text-primaryDark fw-bold me-4 p-2 pt-4 text-center"},"訂單管理",-1),n={class:"overflow-auto mb-3 table-responsive"},p={class:"table caption-top table-hover text-primaryDark text-nowrap"},c=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{scope:"col"},"購買時間"),(0,s._)("th",{scope:"col"},"Email"),(0,s._)("th",{scope:"col"},"購買項目"),(0,s._)("th",{scope:"col"},"應付金額"),(0,s._)("th",{scope:"col"},"是否付款"),(0,s._)("th",{scope:"col"},"編輯"),(0,s._)("th",{scope:"col"},"刪除")])],-1),m={class:"list-unstyled"},u={class:"fw-bold"},g={class:"ps-2"},h={class:"switch"},_=["onUpdate:modelValue","onChange"],w=(0,s._)("span",{class:"slider"},null,-1),x=["onClick"],y=(0,s._)("i",{class:"bi bi-pencil-square cursor-pointer text-primaryDark fs-4 me-6"},null,-1),D=[y],b=["onClick"],f=(0,s._)("i",{class:"bi bi-trash cursor-pointer text-primaryDark fs-4"},null,-1),k=[f];function v(t,e,a,y,f,v){const M=(0,s.up)("LoadingView"),z=(0,s.up)("OrderModal"),$=(0,s.up)("DelModal"),C=(0,s.up)("PagiNation");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(M,{class:"loading",active:f.isLoading},{default:(0,s.w5)((()=>[r])),_:1},8,["active"]),(0,s._)("div",o,[d,(0,s._)("div",n,[(0,s._)("table",p,[c,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(f.orders,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",null,(0,l.zw)(t.$filters.date(e.create_at)),1),(0,s._)("td",null,(0,l.zw)(e.user.email),1),(0,s._)("td",null,[(0,s._)("ul",m,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.products,((t,e)=>((0,s.wg)(),(0,s.iD)("li",{key:e},[(0,s._)("span",u,(0,l.zw)(t.product.title),1),(0,s.Uk)(" / "+(0,l.zw)(t.qty)+" "+(0,l.zw)(t.product.unit),1)])))),128))])]),(0,s._)("td",null,"NT$ "+(0,l.zw)(Math.round(e.total)),1),(0,s._)("td",g,[(0,s._)("label",h,[(0,s.wy)((0,s._)("input",{type:"checkbox","onUpdate:modelValue":t=>e.is_paid=t,onChange:t=>v.updatePaid(e)},null,40,_),[[i.e8,e.is_paid]]),w])]),(0,s._)("td",null,[(0,s._)("div",{class:"editBtn d-flex align-items-center",onClick:t=>v.openModal("edit",e)},D,8,x)]),(0,s._)("td",null,[(0,s._)("div",{class:"delBtn d-flex align-items-center",onClick:t=>v.openModal("delete",e)},k,8,b)])])))),128))])])])]),(0,s.Wm)(z,{ref:"orderModal",temp:f.temp,onUpdateOrders:v.updatePaid},null,8,["temp","onUpdateOrders"]),(0,s.Wm)($,{ref:"delModal",temp:f.temp,onDelItem:v.delOrderItem},null,8,["temp","onDelItem"]),(0,s.Wm)(C,{class:"d-flex justify-content-center pb-3",pages:f.pagination,onUpdatePage:v.getOrders},null,8,["pages","onUpdatePage"])],64)}var M=a(8262),z=a(6294),$=a(6614);const C={class:"modal fade",ref:"modal",tabindex:"-1"},L={class:"modal-dialog modal-dialog-centered modal-xl"},O={class:"modal-content background-transparent"},U={class:"modal-header bg-primaryLight text-center p-3"},P={class:"modal-title text-white"},T=(0,s._)("option",{selected:"",value:""},"配送進度",-1),Z=(0,s._)("option",{value:"已收到訂單"},"已收到訂單",-1),q=(0,s._)("option",{value:"已出貨"},"已出貨",-1),N=[T,Z,q],H={class:"modal-body bg-white text-center p-6"},V={class:"row"},Y={class:"col-10 col-md-5 offset-1"},j={class:"d-flex justify-content-between align-items-center mb-4"},I=(0,s._)("p",{class:"text-primaryDark fw-bold fs-3 p-2"},"訂單內容",-1),K={class:"d-flex mt-3"},S={key:0,class:"text-primaryDark fw-bold me-2"},W={key:1,class:"text-primaryDark fw-bold me-2"},E={class:"switch"},B=(0,s._)("span",{class:"slider"},null,-1),A={class:"d-flex align-items-center"},F=["src","alt"],G={class:"cart-body text-start"},J={class:"fw-bold"},Q={class:"fw-bold text-primaryDark"},R={key:0,class:"text-danger fw-bold"},X={class:"fs-4 fw-bold text-end"},tt={class:"col-10 col-md-5 bg-light shadow-sm ms-5"},et={class:"position-sticky top-20"},at=(0,s._)("div",{class:"d-flex justify-content-between align-items-center"},[(0,s._)("p",{class:"bg-light text-primaryDark fw-bold fs-3 p-2"},"用戶資訊")],-1),st={class:"table mt-4 fs-6"},lt={class:"text-start"},it=(0,s._)("th",{class:"text-primaryDark",scope:"row"},"下單時間",-1),rt={class:"text-primaryDark"},ot={class:"text-start"},dt=(0,s._)("th",{class:"text-primaryDark",scope:"row"},"Email",-1),nt={class:"text-primaryDark"},pt={class:"text-start"},ct=(0,s._)("th",{class:"text-primaryDark",scope:"row"},"收件人姓名",-1),mt={class:"text-primaryDark"},ut={class:"text-start"},gt=(0,s._)("th",{class:"text-primaryDark",scope:"row"},"電話號碼",-1),ht={class:"text-primaryDark"},_t={class:"text-start"},wt=(0,s._)("th",{class:"text-primaryDark",scope:"row"},"收件地址",-1),xt={class:"text-primaryDark"},yt={key:0,class:"text-start"},Dt=(0,s._)("th",{class:"text-primaryDark",scope:"row"},"付款方式",-1),bt={class:"text-primaryDark"},ft={key:1,class:"text-start"},kt=(0,s._)("th",{class:"text-primaryDark",scope:"row"},"備註",-1),vt={class:"text-primaryDark"},Mt={class:"modal-footer flex-nowrap w-100"},zt=(0,s._)("button",{type:"button",class:"btn btn-outline-primary","data-bs-dismiss":"modal"},"取消",-1);function $t(t,e,a,r,o,d){return(0,s.wg)(),(0,s.iD)("div",C,[(0,s._)("div",L,[(0,s._)("div",O,[(0,s._)("div",U,[(0,s._)("h4",P,"訂單編號 : "+(0,l.zw)(t.tempModalData.id),1),(0,s.wy)((0,s._)("select",{class:"form-select form-select-sm bg-light box-shadow-none w-auto","onUpdate:modelValue":e[0]||(e[0]=e=>t.tempModalData.orderStatus=e)},N,512),[[i.bM,t.tempModalData.orderStatus]])]),(0,s._)("div",H,[(0,s._)("div",V,[(0,s._)("div",Y,[(0,s._)("div",j,[I,(0,s._)("div",K,[t.tempModalData.is_paid?((0,s.wg)(),(0,s.iD)("span",S,"已付款")):((0,s.wg)(),(0,s.iD)("span",W,"未付款")),(0,s._)("label",E,[(0,s.wy)((0,s._)("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=e=>t.tempModalData.is_paid=e)},null,512),[[i.e8,t.tempModalData.is_paid]]),B])])]),(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.tempModalData.products,(t=>((0,s.wg)(),(0,s.iD)("li",{class:"d-flex justify-content-between align-items-center py-2",key:t.id},[(0,s._)("div",A,[(0,s._)("img",{class:"me-4",style:{height:"80px",width:"110px"},src:t.product.imageUrl,alt:t.product.title},null,8,F),(0,s._)("div",G,[(0,s._)("p",J,(0,l.zw)(t.product.title),1),(0,s._)("p",Q,"NT$ "+(0,l.zw)(Math.round(t.final_total)),1),t.coupon?((0,s.wg)(),(0,s.iD)("p",R,"已套用優惠券")):(0,s.kq)("",!0)])]),(0,s._)("div",null,[(0,s._)("p",null,"x "+(0,l.zw)(t.qty),1)])])))),128))]),(0,s._)("p",X," 總計金額:NT$"+(0,l.zw)(Math.round(t.tempModalData.total)),1)]),(0,s._)("div",tt,[(0,s._)("div",et,[at,(0,s._)("table",st,[(0,s._)("tbody",null,[(0,s._)("tr",lt,[it,(0,s._)("td",rt,(0,l.zw)(this.$filters.date(t.tempModalData.create_at)),1)]),(0,s._)("tr",ot,[dt,(0,s._)("td",nt,(0,l.zw)(t.tempModalData.user?.email),1)]),(0,s._)("tr",pt,[ct,(0,s._)("td",mt,(0,l.zw)(t.tempModalData.user?.name),1)]),(0,s._)("tr",ut,[gt,(0,s._)("td",ht,(0,l.zw)(t.tempModalData.user?.tel),1)]),(0,s._)("tr",_t,[wt,(0,s._)("td",xt,(0,l.zw)(t.tempModalData.user?.address),1)]),t.tempModalData.user?.payment?((0,s.wg)(),(0,s.iD)("tr",yt,[Dt,(0,s._)("td",bt,(0,l.zw)(t.tempModalData.user?.payment),1)])):(0,s.kq)("",!0),t.tempModalData.message?((0,s.wg)(),(0,s.iD)("tr",ft,[kt,(0,s._)("td",vt,(0,l.zw)(t.tempModalData.message),1)])):(0,s.kq)("",!0)])])])])])]),(0,s._)("div",Mt,[zt,(0,s._)("button",{type:"button",class:"btn btn-primary text-white",onClick:e[2]||(e[2]=e=>t.$emit("update-orders",t.tempModalData))},"確定修改")])])])],512)}var Ct=a(1339),Lt={mixins:[Ct.Z],watch:{temp:{handler(){this.tempModalData.orderStatus||(this.tempModalData.orderStatus="已收到訂單")},deep:!0}}},Ot=a(3744);const Ut=(0,Ot.Z)(Lt,[["render",$t]]);var Pt=Ut,Tt=a(5252),Zt={data(){return{temp:[],orders:[],pagination:[],isLoading:!1}},components:{PagiNation:$.Z,OrderModal:Pt,DelModal:Tt.Z},methods:{...(0,M.nv)(z.Z,["pushMsg"]),getOrders(t=null,e=1){this.isLoading=!0,this.$http.get(`https://vue3-course-api.hexschool.io/api/claire-api/admin/orders?page=${e}`).then((t=>{this.orders=t.data.orders,this.pagination=t.data.pagination,this.isLoading=!1})).catch((()=>{this.isLoading=!1}))},openModal(t,e){"edit"===t?(this.temp={...e},this.$refs.orderModal.openModal()):"delete"===t&&(this.temp={...e},this.$refs.delModal.openModal())},updatePaid(t){this.temp=t,this.isLoading=!0,this.$http.put(`https://vue3-course-api.hexschool.io/api/claire-api/admin/order/${t.id}`,{data:this.temp}).then((t=>{this.pushMsg(t,"更新","已成功更新付款狀態"),this.isLoading=!1,this.$refs.orderModal.hideModal(),this.getOrders()})).catch((()=>{this.pushMsg(!1,"更新","更新付款狀態失敗"),this.isLoading=!1}))},delOrderItem(t){this.isLoading=!0,this.$http.delete(`https://vue3-course-api.hexschool.io/api/claire-api/admin/order/${t.id}`).then((t=>{this.pushMsg(t,"更新","已成功刪除訂單"),this.isLoading=!1,this.$refs.delModal.hideModal(),this.getOrders()})).catch((()=>{this.pushMsg(!1,"更新","刪除訂單失敗"),this.isLoading=!1}))}},mounted(){this.getOrders()}};const qt=(0,Ot.Z)(Zt,[["render",v]]);var Nt=qt}}]);
//# sourceMappingURL=429.c486f049.js.map